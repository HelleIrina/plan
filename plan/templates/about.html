{% extends "base_site.html" %}
{% load translation %}
{% load compress %}
{% load json %}
{% load color %}

{% block title %}
    {# {% trans "About the Timetable generator for NTNU students" %} #}
    {% trans "Number of timetables over time" %}
{% endblock %}

{% block hd %}
    <h1>
        {# {% trans "About the Timetable generator for NTNU students" %} #}
        {% trans "Number of timetables over time" %}
    </h1>
{% endblock %}

{% block bd %}
{% comment %}
    <div class="yui-gb">
        <div class="yui-u first">
            <h2>Fall 2008</h2>
            <p>
Lorem ipsum dolor sit amet, consectetur adipiscing elit. Quisque nec sapien
sem. Nam pretium consectetur leo, ut semper diam blandit et. Pellentesque eget
diam et enim laoreet sodales. Donec tempor feugiat laoreet. Mauris nec felis
orci. Aenean blandit augue et orci dignissim condimentum at sed libero.
Pellentesque ac mi consectetur purus rhoncus sollicitudin at non felis. Etiam
consectetur odio in augue auctor iaculis.
            </p>
        </div>
        <div class="yui-u">
            <h2>Summer 2009</h2>
            <p>
Morbi nec lorem ipsum, in accumsan mi. Aliquam iaculis ultricies mauris id
ultricies. Lorem ipsum dolor sit amet, consectetur adipiscing elit. Nullam ut
faucibus elit. Donec fringilla interdum nunc eget porttitor. Quisque tristique
viverra nunc in faucibus. Nulla dignissim porta nisl in semper. Morbi
pellentesque, libero vitae facilisis pretium, turpis eros hendrerit arcu, eget
fermentum diam sem in lorem.
            </p>
        </div>
        <div class="yui-u">
            <h2>2010&hellip;</h2>
            <p>
Maecenas eget arcu ut sapien pharetra feugiat eget sed enim. Maecenas elementum
dictum tincidunt. Praesent molestie orci nec odio egestas dapibus. Praesent
laoreet mauris vel velit ullamcorper vitae pretium purus suscipit. Phasellus a
auctor dui. Phasellus in sodales purus. Mauris eget nibh tellus. Quisque auctor
porta pharetra. Donec nec volutpat magna. Lorem ipsum dolor sit amet,
consectetur adipiscing elit.
            </p>
        </div>
    </div>
{% endcomment %}

    {# <h2>Timetables per semester</h2> #}
    <div id="graph" style="width: 100%; height: 25em">
    </div>
{% endblock %}

{% block extrascript %}
    <!--[if IE]><script language="javascript" type="text/javascript" src="{{ STATIC_URL }}js/excanvas.min.js"></script><![endif]-->
    {% compress js %}
        <script type="text/javascript" src="{{ STATIC_URL}}js/jquery-1.3.1.min.js"></script>
        <script type="text/javascript" src="{{ STATIC_URL}}js/jquery.flot.min.js"></script>
    {% endcompress %}

    <script type="text/javascript">
        $(document).ready(function() {
            var fills = [];
            {% for a in stats %}
            fills.push("{% color forloop.counter %}");{% endfor %}

            var stats = {{ stats|json }};
            var max_x = 0;
            var series = [];
            var options = {
                xaxis: { mode: "time" },
                yaxis: { min: 0 }
            };
            var color = "#333";

            for (var i = 0; i < stats.length; i++) {
                var x = stats[i][0][0]*1000 - 60*60*24*1000;
                var y = 0;
                var data = [[x, y]];
                var fill = $.color.parse(fills[i]).scale('a', 0.5);
                var lines = {
                    show: true,
                    lineWidth: 1,
                    fill: true,
                    fillColor: fill.toString(),
                }

                for (var j = 0; j < stats[i].length; j++) {
                    x  = stats[i][j][0] * 1000;
                    y += stats[i][j][1];

                    data .push([x, y]);
                    max_x = x > max_x ? x : max_x;
                }
                series.push({data: data, lines: lines, color: color.toString()});
            }

            for (var i = 0; i < series.length; i++) {
                series[i].data.push([max_x, series[i].data[series[i].data.length-1][1]]);
            }

            $.plot($('#graph'), series, options);
        });
    </script>
{% endblock %}
