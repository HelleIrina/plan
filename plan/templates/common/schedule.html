{% extends "base.html" %}

{% block title %}
    {{ slug }}'{% ifnotequal slug|lower|slice:"-1:" "s" %}s{% endifnotequal %} {{ semester }} {{ year }} {{ block.super }}
{% endblock %}

{% block content %}
<h1>{{ slug }}'{% ifnotequal slug|lower|slice:"-1:" "s" %}s{% endifnotequal %}  {{ semester }} {{ year }} schedule</h1>
<table class="schedule">
    <thead>
        <tr>
            <th class="time"></th>
            <th colspan="{{ colspan.0 }}">Monday</th>
            <th colspan="{{ colspan.1 }}">Tuesday</th>
            <th colspan="{{ colspan.2 }}">Wednesday</th>
            <th colspan="{{ colspan.3 }}">Thursday</th>
            <th colspan="{{ colspan.4 }}">Friday</th>
        </tr>
    </thead>
    <tbody>
    {% for row in table %}
        <tr class="{% cycle odd,even %}">
            {% for cells in row %}
                {% if cells %}
                    {% for c in cells %}
                        {% if not c.remove %}
                            <td colspan="{{ c.colspan|default:"1" }}" rowspan="{{ c.rowspan|default:"1" }}" {% if c.class or forloop.first %}class="{% if forloop.first %}first {% endif %}{{ c.class }}"{% endif %}>
                                {% if c.lecture %}
                                    <div class="course" title="{{ c.lecture.course.full_name }}">{{ c.lecture.course }}</div>
                                    <div class="type">{{ c.lecture.type }}</div>
                                    <div class="room">{{ c.lecture.room }}</div>
                                    {% comment %}
                                        <div class="groups">
                                            {% for g in c.lecture.groups.all %}
                                                {{ g }}{% if not forloop.last %},{% endif %}
                                             {% endfor %}
                                        </div>
                                    {% endcomment %}
                                {% endif %}
                                {% if c.time %}
                                    {{ c.time }}
                                {% endif %}
                            </td>
                        {% endif %}
                    {% endfor %}
                {% else %}
                    <td></td>
                {% endif %}
            {% endfor %}
        </tr>
    {% endfor %}

    </tbody>
</table>
<form action="{% url select_course slug %}" method="post">
    <div class="yui-g">
        {% for course in legend %}
            <div class="{{ course.css_class }} legend left" title="{{ course.full_name }}">
                <label>
                    <input type="checkbox" name="course" value="{{ course.id }}" />
                    {% if course.url %}
                        <a href="{{ course.url }}">{{ course }}</a>
                    {% else %}
                        {{ course }}
                    {% endif %}
                </label>
            </div>
        {% endfor %}
        <p class="left">
            <input type="text" name="course" size="16"/>
            <button name="submit_add">Add</button>
            <button name="submit_remove">Remove selected</button>
            {% if request.GET.groups %}
                <a href=".">Hide group options</a>
            {% else %}
                <a href="?groups=1">Group options</a>
            {% endif %}
        </p>
    </div>
</form>

{% if request.GET.groups %}
    <form action="{% url select_groups slug %}" method="post">
        <div class="yui-g">
            {% for course,groups in courses %}
                <p class="{{ course.css_class }} legend left box">
                    <b>{{ course }}</b> <br />
                    <span class="small">{{ course.full_name }}</span> <br />
                    {{ groups.groups }}
                </p>
            {% endfor %}
            <p>
                <button>Save groups</button>
            </p>
        </div>
    </form>
{% endif %}

{% endblock %}
